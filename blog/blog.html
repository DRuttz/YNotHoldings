<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog | YNot Holdings</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
  <!-- Header Injection -->
  <div id="header-container"></div>

  <main class="container mx-auto px-4 py-12 max-w-5xl">
    <h1 class="text-3xl font-bold text-blue-600 mb-8">Our Blog</h1>
    
    <!-- Search Bar -->
    <div class="mb-8">
      <input 
        type="text" 
        id="search-input" 
        placeholder="Search posts..." 
        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"
      >
    </div>

    <!-- Blog Posts Container -->
    <div id="blog-posts" class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
      <!-- Posts load here dynamically -->
      <p class="text-gray-500">Loading posts...</p>
    </div>
  </main>

  <!-- Footer Injection -->
  <div id="footer-container"></div>

  <script>
    // Load Header/Footer (same as other pages)
    document.addEventListener("DOMContentLoaded", function() {
      fetch('/YNotHoldings/header.html')
        .then(res => res.text())
        .then(data => {
          document.getElementById('header-container').innerHTML = data;
          initMobileMenu();
        });

      fetch('/YNotHoldings/footer.html')
        .then(res => res.text())
        .then(data => {
          document.getElementById('footer-container').innerHTML = data;
        });

      // Load Blog Posts
      fetchBlogPosts();
    });

    // Fetch posts from JSON
    function fetchBlogPosts() {
      fetch('/YNotHoldings/data/blog-posts.json')
        .then(res => res.json())
        .then(posts => {
          renderPosts(posts);
          setupSearch(posts);
        })
        .catch(err => {
          console.error("Error loading posts:", err);
          document.getElementById('blog-posts').innerHTML = 
            '<p class="text-red-500">Failed to load posts. Refresh or try later.</p>';
        });
    }

    // Render all posts
    function renderPosts(posts) {
      const container = document.getElementById('blog-posts');
      if (posts.length === 0) {
        container.innerHTML = '<p class="text-gray-500">No posts yet. Check back soon!</p>';
        return;
      }

      container.innerHTML = posts.map(post => `
        <article class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
          <div class="p-6">
            <h2 class="text-xl font-bold mb-2">${post.title}</h2>
            <p class="text-gray-600 mb-2">
              <span>${post.date}</span> â€¢ <span>${post.author}</span>
            </p>
            <p class="text-gray-700 mb-4 line-clamp-3">${post.content}</p>
            <div class="flex flex-wrap gap-2 mb-4">
              ${post.tags.map(tag => `<span class="px-2 py-1 bg-gray-100 text-gray-600 rounded-full text-xs">${tag}</span>`).join('')}
            </div>
            <a href="#" class="text-blue-600 hover:underline">Read More</a>
          </div>
        </article>
      `).join('');
    }

    // Search functionality
    function setupSearch(allPosts) {
      const searchInput = document.getElementById('search-input');
      searchInput.addEventListener('input', (e) => {
        const term = e.target.value.toLowerCase();
        const filtered = allPosts.filter(post => 
          post.title.toLowerCase().includes(term) || 
          post.content.toLowerCase().includes(term) ||
          post.tags.some(tag => tag.toLowerCase().includes(term))
        );
        renderPosts(filtered);
      });
    }

    // Mobile menu (same as other pages)
    function initMobileMenu() {
      const menuBtn = document.getElementById('menu-btn');
      const closeBtn = document.getElementById('close-btn');
      const mobileMenu = document.getElementById('mobile-menu');
      const overlay = document.getElementById('overlay');

      if (menuBtn) menuBtn.addEventListener('click', () => {
        mobileMenu.classList.remove('-translate-x-full');
        overlay.classList.remove('hidden');
      });

      if (closeBtn) closeBtn.addEventListener('click', () => {
        mobileMenu.classList.add('-translate-x-full');
        overlay.classList.add('hidden');
      });

      if (overlay) overlay.addEventListener('click', () => {
        mobileMenu.classList.add('-translate-x-full');
        overlay.classList.add('hidden');
      });
    }
  </script>
</body>
</html>